alias userSP R3;
alias physicalSP R4;
alias address R5;

userSP = SP;

read;

physicalSP = [PTBR +  ( userSP / 512 ) * 2] * 512 + (userSP % 512);

address = [[PTBR+2*(userSP-3)/512]*512+(userSP-3)%512];

// translate adress
address = [PTBR + (address/512) * 2 ] * 512 + (address % 512);


[address] = P0;

[[PTBR+2*(userSP-1)/512]*512+(userSP-1)%512] = 0;

ireturn;
